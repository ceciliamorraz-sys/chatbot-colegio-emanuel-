<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EmaBot Widget</title>
  <style>
    :root{
      --brand:#1e4ed8;
      --brand2:#0ea5e9;
      --panel:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --line:#e2e8f0;
      --soft:#f1f5f9;
      --ok:#22c55e;
      --shadow: 0 14px 38px rgba(2,6,23,.28);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      background:#0b1220;
      min-height:100vh;
    }

    /* =========================
       BOT√ìN FLOTANTE (PLEGABLE)
       ========================= */
    .fab{
      position:fixed;
      right:18px;
      bottom:18px;
      display:flex;
      align-items:center;
      gap:10px;
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      color:white;
      border:none;
      border-radius:999px;
      padding:12px 14px;
      box-shadow: var(--shadow);
      cursor:pointer;
      font-weight:900;
      z-index:9999;
      user-select:none;
      transition: transform .12s ease, filter .12s ease;
    }
    .fab:hover{transform: translateY(-1px); filter: brightness(1.02)}
    .fab:active{transform: translateY(0px)}
    .fab .ico{
      width:34px; height:34px;
      border-radius:14px;
      background: rgba(255,255,255,.14);
      border:1px solid rgba(255,255,255,.25);
      display:grid; place-items:center;
      box-shadow: 0 10px 22px rgba(0,0,0,.18);
    }
    .fab small{font-weight:700; opacity:.92}

    /* =========================
       PANEL / WIDGET
       ========================= */
    .widget{
      position:fixed;
      right:18px;
      bottom:18px;
      width:min(420px, calc(100vw - 36px));
      background: var(--panel);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      z-index:10000;
      transform: translateY(10px);
      opacity:0;
      pointer-events:none;
      transition: opacity .16s ease, transform .16s ease;
    }
    .widget.open{
      transform: translateY(0);
      opacity:1;
      pointer-events:auto;
    }

    .topbar{
      padding:14px;
      color:white;
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .brand{
      display:flex; gap:10px; align-items:center;
      min-width:0;
    }
    .avatar{
      width:38px; height:38px;
      border-radius:14px;
      background: rgba(255,255,255,.16);
      border:1px solid rgba(255,255,255,.25);
      display:grid; place-items:center;
    }
    .title{min-width:0; line-height:1.05}
    .title b{display:block; font-size:14.5px}
    .title small{
      display:flex; align-items:center; gap:7px;
      font-size:12px; opacity:.94;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background: var(--ok);
      box-shadow:0 0 0 4px rgba(34,197,94,.18);
      animation: pulse 1.6s ease-in-out infinite;
      flex:0 0 auto;
    }
    @keyframes pulse{
      0%,100%{transform:scale(1); opacity:.9}
      50%{transform:scale(1.25); opacity:1}
    }

    .actions{display:flex; gap:8px; align-items:center}
    .iconbtn{
      width:34px; height:34px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.25);
      background: rgba(255,255,255,.12);
      color:white;
      cursor:pointer;
      display:grid; place-items:center;
      user-select:none;
      transition: transform .12s ease, background .12s ease;
    }
    .iconbtn:hover{transform: translateY(-1px); background: rgba(255,255,255,.18)}

    .body{
      padding:14px;
      background: linear-gradient(180deg, #ffffff, #ffffff 62%, #f8fafc);
    }

    .banner{
      border:1px solid rgba(226,232,240,.95);
      background: linear-gradient(135deg, rgba(30,78,216,.10), rgba(14,165,233,.10));
      border-radius: 16px;
      padding:12px;
      margin-bottom:12px;
    }
    .banner b{color:var(--text)}
    .banner .sub{color:var(--muted); font-size:12.5px; margin-top:4px; line-height:1.35;}
    .ctaRow{display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;}
    .pill{
      border:1px solid var(--line);
      background:white;
      border-radius:999px;
      padding:8px 10px;
      font-weight:900;
      font-size:12.5px;
      cursor:pointer;
      user-select:none;
      display:inline-flex; align-items:center; gap:8px;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .pill:hover{transform: translateY(-1px); background:#f1f5f9; border-color:#cbd5e1}
    .pill.primary{
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      color:white;
      border-color: transparent;
    }

    .chat{
      height: 300px;
      overflow:auto;
      padding: 10px;
      background: #f8fafc;
      border:1px solid var(--line);
      border-radius: 16px;
      position:relative;
    }
    .typing{
      position:absolute;
      bottom:10px;
      left:10px;
      background:white;
      border:1px solid var(--line);
      border-radius: 999px;
      padding:6px 10px;
      font-size:12px;
      color:var(--muted);
      box-shadow: 0 6px 16px rgba(2,6,23,.05);
      display:none;
      align-items:center;
      gap:8px;
    }
    .dots{display:inline-flex; gap:3px;}
    .dots span{
      width:5px; height:5px; border-radius:50%;
      background:#94a3b8;
      opacity:.4;
      animation: bounce 1.1s infinite;
    }
    .dots span:nth-child(2){animation-delay:.15s}
    .dots span:nth-child(3){animation-delay:.30s}
    @keyframes bounce{
      0%,100%{transform: translateY(0); opacity:.35}
      50%{transform: translateY(-3px); opacity:.9}
    }

    .msg{display:flex; gap:10px; margin: 10px 0; align-items:flex-end;}
    .bubble{
      max-width: 86%;
      padding: 10px 12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background:white;
      color: var(--text);
      box-shadow: 0 8px 18px rgba(2,6,23,.05);
      font-size: 13.5px;
      line-height: 1.35;
      white-space: pre-line;
    }
    .msg.bot .bubble{border-left: 4px solid var(--brand)}
    .msg.user{justify-content:flex-end}
    .msg.user .bubble{
      background: linear-gradient(135deg, #dbeafe, #eef2ff);
      border-left: 4px solid #60a5fa;
    }

    .tiny{
      font-size:11px;
      color:var(--muted);
      margin-top:6px;
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }

    .row{display:flex; gap:10px; margin-top:10px;}
    .row .btn{flex:1;}
    .btn{
      border:1px solid var(--line);
      background: white;
      border-radius: 14px;
      padding: 10px 12px;
      cursor:pointer;
      font-weight:900;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      min-height:44px;
    }
    .btn:hover{transform: translateY(-1px); background:#f1f5f9; border-color:#cbd5e1}
    .btn.primary{
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      color:white;
      border-color: transparent;
    }
    .btn.danger{
      background: linear-gradient(135deg, #ef4444, #f97316);
      color:white;
      border-color: transparent;
    }

    .composer{display:flex; gap:10px; margin-top:10px; align-items:center;}
    input[type="text"]{
      flex:1;
      border:1px solid var(--line);
      border-radius: 14px;
      padding: 12px 12px;
      font-size: 14px;
      outline:none;
      background:white;
    }
    input[type="text"]:focus{border-color:#93c5fd; box-shadow:0 0 0 4px rgba(147,197,253,.25)}
    .send{width:96px;}

    .card{
      border:1px solid var(--line);
      background:white;
      border-radius:16px;
      padding:14px;
      box-shadow: 0 8px 22px rgba(2,6,23,.06);
      margin-top:12px;
    }
    .card h3{margin:0 0 6px 0; font-size:15px; color:var(--text);}
    .meta{color:var(--muted); font-size:12.5px; line-height:1.35;}
    .mini{font-size:12px; color:var(--muted); margin-top:8px;}
    .hidden{display:none!important;}

    .formGrid{display:grid; gap:10px; margin-top:10px;}
    .formGrid input, .formGrid textarea{
      width:100%;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
      font-size:14px;
      outline:none;
      background:white;
    }
    .formGrid textarea{min-height:90px; resize:vertical;}
    .formGrid input:focus,.formGrid textarea:focus{
      border-color:#93c5fd;
      box-shadow:0 0 0 4px rgba(147,197,253,.25)
    }
  </style>
</head>

<body>

  <!-- Bot√≥n flotante -->
  <button class="fab" id="fab" aria-label="Abrir asistente">
    <span class="ico">ü§ñ</span>
    <span>
      EmaBot <small>‚Ä¢ Ayuda r√°pida</small>
    </span>
  </button>

  <!-- Widget plegable -->
  <div class="widget" id="widget" role="application" aria-label="EmaBot Asistente Virtual">
    <div class="topbar">
      <div class="brand">
        <div class="avatar" aria-hidden="true">ü§ñ</div>
        <div class="title">
          <b>EmaBot ‚Äì Asistente Virtual</b>
          <small><span class="dot" aria-hidden="true"></span><span id="schoolName">Colegio Integral Emanuel</span></small>
        </div>
      </div>
      <div class="actions">
        <button class="iconbtn" id="btnVoice" title="Voz: activar/desactivar" aria-label="Voz">üîä</button>
        <button class="iconbtn" id="btnMin" title="Minimizar" aria-label="Minimizar">‚Äî</button>
        <button class="iconbtn" id="btnClose" title="Cerrar" aria-label="Cerrar">‚úï</button>
      </div>
    </div>

    <div class="body">
      <div class="banner">
        <b>‚ú® Informaci√≥n del colegio en segundos</b>
        <div class="sub">
          Escribe tu consulta o usa los botones. Si no encuentro una respuesta segura, te env√≠o directo a WhatsApp.
        </div>
        <div class="ctaRow">
          <div class="pill primary" id="ctaEnroll">üìù Matr√≠cula</div>
          <div class="pill" id="ctaMaps">üìç Google Maps</div>
          <div class="pill" id="ctaWa">üí¨ WhatsApp</div>
        </div>
      </div>

      <div class="chat" id="chat" aria-live="polite">
        <div class="typing" id="typing">
          <span><b>EmaBot</b> est√° escribiendo</span>
          <span class="dots" aria-hidden="true"><span></span><span></span><span></span></span>
        </div>
      </div>

      <div class="row">
        <button class="btn" data-action="matricula">üìù Matr√≠cula</button>
        <button class="btn" data-action="horarios">‚è∞ Horarios</button>
      </div>
      <div class="row">
        <button class="btn" data-action="ubicacion">üìç Ubicaci√≥n</button>
        <button class="btn" data-action="oferta">üìö Oferta</button>
      </div>
      <div class="row">
        <button class="btn" data-action="contacto">üìû Contacto</button>
        <button class="btn danger" data-action="humano">üßë‚Äçüíº Administraci√≥n</button>
      </div>

      <div class="composer">
        <input id="input" type="text" placeholder="Escribe tu consulta aqu√≠‚Ä¶" autocomplete="off" />
        <button class="btn primary send" id="sendBtn">Enviar</button>
      </div>

      <!-- Formulario correo -->
      <div class="card" id="mailCard">
        <h3>‚úâÔ∏è Escribir por correo</h3>
        <div class="meta">Completa el formulario y se abrir√° tu correo con el mensaje listo para enviar.</div>

        <div class="formGrid">
          <input id="fName" type="text" placeholder="Tu nombre" />
          <input id="fEmail" type="email" placeholder="Tu correo (opcional)" />
          <textarea id="fMsg" placeholder="Escribe tu mensaje‚Ä¶"></textarea>
          <button class="btn" id="btnMail">Enviar por correo</button>
        </div>

        <div class="mini">
          üßæ Nota: Esto usa <b>mailto:</b> (abre Gmail/Outlook instalado o configurado en el dispositivo).
        </div>
      </div>

      <div class="mini">
        üè´ Este asistente brinda orientaci√≥n informativa y no reemplaza la atenci√≥n directa del colegio.
      </div>
    </div>
  </div>

<script>
/* =========================
   CONFIGURACI√ìN
   ========================= */
const CONFIG = {
  schoolName: "Colegio Integral Emanuel",

  // üìç Pega tu enlace real de Google Maps
  mapsLink: "https://maps.app.goo.gl/PLdAiWjSFv9Y2ubG8",

  // üìû Contacto que pediste
  phoneDisplay: "58057682",
  // WhatsApp recomendado con c√≥digo pa√≠s (Nicaragua 505)
  whatsappNumber: "50558057682",

  // Correo destino (c√°mbialo)
  emailTo: "colegio@ejemplo.com",

  // Contenidos base
  officeHours: "Lunes a Viernes | 7:00 a.m. ‚Äì 3:00 p.m.",
  addressText: "Escribe aqu√≠ la direcci√≥n del colegio (barrio, calles, referencias).",
  academicOffer: [
    "üìö Niveles: Preescolar ‚Ä¢ Primaria ‚Ä¢ Secundaria",
    "üß© Actividades: deportivas, culturales y refuerzo acad√©mico (seg√∫n plan del centro)."
  ],
  enrollmentInfo: {
    general: [
      "‚úÖ Requisitos comunes: Partida de nacimiento, c√©dula del tutor, r√©cord de notas (si aplica), 2 fotos tama√±o carnet.",
      "‚úÖ Proceso: 1) Solicitud 2) Revisi√≥n 3) Pago 4) Confirmaci√≥n de cupo."
    ]
  }
};

/* =========================
   ESTADO
   ========================= */
const state = {
  voiceEnabled: true,
  greeted: false,
  pendingSlot: null,   // "nivel"
  lastIntent: null
};

/* =========================
   HELPERS
   ========================= */
const $ = (s) => document.querySelector(s);
const fab = $("#fab");
const widget = $("#widget");
const chat = $("#chat");
const input = $("#input");
const typing = $("#typing");
$("#schoolName").textContent = CONFIG.schoolName;

function openWidget(){
  widget.classList.add("open");
  fab.style.display = "none";
  if(!state.greeted) greet();
  setTimeout(() => input.focus(), 50);
}
function closeWidget(){
  widget.classList.remove("open");
  fab.style.display = "flex";
}
function minimizeWidget(){
  closeWidget();
}

function scrollDown(){ chat.scrollTop = chat.scrollHeight; }
function showTyping(ms=650){
  typing.style.display = "inline-flex";
  scrollDown();
  setTimeout(()=> typing.style.display="none", ms);
}

function addMsg(text, who="bot"){
  const row = document.createElement("div");
  row.className = `msg ${who}`;
  const bubble = document.createElement("div");
  bubble.className = "bubble";
  bubble.textContent = text;
  row.appendChild(bubble);
  chat.appendChild(row);

  if(who === "bot"){
    const tiny = document.createElement("div");
    tiny.className = "tiny";
    tiny.innerHTML = `
      <span>¬øTe sirvi√≥?</span>
      <span class="linklike" data-feedback="up">üëç S√≠</span>
      <span class="linklike" data-feedback="down">üëé No</span>
      <span class="linklike" data-action="humano">üí¨ WhatsApp</span>
    `;
    row.appendChild(tiny);
  }

  scrollDown();
}

function speak(text){
  if(!state.voiceEnabled) return;
  if(!("speechSynthesis" in window)) return;
  window.speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "es-ES";
  u.rate = 1.02;
  u.pitch = 1.0;
  window.speechSynthesis.speak(u);
}

/* =========================
   CONTACTO / ESCALAMIENTO
   ========================= */
function openWhatsApp(prefill=""){
  const url = `https://wa.me/${CONFIG.whatsappNumber}${prefill ? `?text=${encodeURIComponent(prefill)}` : ""}`;
  window.open(url, "_blank");
}
function callPhone(){
  window.location.href = `tel:${CONFIG.phoneDisplay}`;
}

function escalateUnknown(userText=""){
  state.lastIntent = "humano";
  showTyping(650);

  const prefill =
`Hola, necesito informaci√≥n del ${CONFIG.schoolName}.
Mi consulta fue: "${userText || "‚Äî"}"`;

  addMsg(
`üßë‚Äçüíº No encontr√© una respuesta segura para tu consulta.\n\nTe enviar√© a WhatsApp para atenci√≥n directa ‚úÖ\n\nüìû Tel√©fono: ${CONFIG.phoneDisplay}\nüí¨ WhatsApp: https://wa.me/${CONFIG.whatsappNumber}\n\n(Se abrir√° WhatsApp autom√°ticamente.)`
  );
  speak("Te enviar√© a WhatsApp para atenci√≥n directa.");
  // Abrir WhatsApp autom√°ticamente
  openWhatsApp(prefill);
}

/* =========================
   INTENCI√ìN (simple keywords)
   ========================= */
const INTENTS = [
  {name:"matricula", keys:["matricula","matr√≠cula","inscripci√≥n","inscripcion","requisitos","cupo","pago","arancel","precio"]},
  {name:"horarios", keys:["horario","horarios","entrada","salida","turno","atenci√≥n","atencion"]},
  {name:"ubicacion", keys:["ubicaci√≥n","ubicacion","direcci√≥n","direccion","mapa","como llegar","donde queda"]},
  {name:"oferta", keys:["oferta","niveles","preescolar","primaria","secundaria","grados","materias","programa"]},
  {name:"contacto", keys:["contacto","telefono","tel√©fono","whatsapp","correo","email","llamar","escribir"]},
  {name:"humano", keys:["administraci√≥n","administracion","secretaria","secretar√≠a","persona","humano","coordinaci√≥n","director"]}
];

function detectIntent(text){
  const t = (text||"").toLowerCase();
  for(const it of INTENTS){
    for(const k of it.keys){
      if(t.includes(k)) return it.name;
    }
  }
  return "desconocido";
}

/* =========================
   RESPUESTAS
   ========================= */
function greet(){
  state.greeted = true;
  showTyping(650);
  addMsg(`üåü ¬°Hola! Soy EmaBot.\nPuedo ayudarte con matr√≠cula, horarios, ubicaci√≥n y contacto.\nSi tu consulta es muy espec√≠fica, te env√≠o directo a WhatsApp ‚úÖ`);
  speak("Hola. Soy EmaBot. Puedo ayudarte con informaci√≥n del colegio.");
}

function respond(intent, userText=""){
  state.lastIntent = intent;

  // Slot ‚Äúnivel‚Äù (si quisieras profundizar matr√≠cula)
  if(state.pendingSlot === "nivel"){
    const s = (userText||"").toLowerCase();
    if(!["preescolar","primaria","secundaria","1","2","3"].some(x => s.includes(x))){
      state.pendingSlot = null;
      return escalateUnknown(userText);
    }
    state.pendingSlot = null;
    showTyping(650);
    addMsg(`üìù Matr√≠cula\n\n${CONFIG.enrollmentInfo.general.join("\n")}\n\nSi deseas detalles por nivel, escribe: Preescolar / Primaria / Secundaria.`);
    speak("Te comparto informaci√≥n de matr√≠cula.");
    return;
  }

  if(intent === "matricula"){
    showTyping(650);
    addMsg(`üìù Matr√≠cula\n\n${CONFIG.enrollmentInfo.general.join("\n")}\n\n¬øDeseas informaci√≥n por nivel? (Preescolar / Primaria / Secundaria)`);
    speak("Te comparto informaci√≥n de matr√≠cula.");
    // Puedes activar esto si quieres obligar a nivel:
    // state.pendingSlot = "nivel";
    return;
  }

  if(intent === "horarios"){
    showTyping(650);
    addMsg(`‚è∞ Horario de atenci√≥n\n\n${CONFIG.officeHours}\n\n¬øNecesitas tambi√©n horarios de clases por nivel?`);
    speak("Te comparto el horario de atenci√≥n.");
    return;
  }

  if(intent === "ubicacion"){
    if(!CONFIG.mapsLink || CONFIG.mapsLink.includes("PEGA_AQUI")){
      return escalateUnknown("Ubicaci√≥n (falta configurar el mapLink).");
    }
    showTyping(650);
    addMsg(`üìç Ubicaci√≥n\n\n${CONFIG.addressText}\n\nüó∫Ô∏è Google Maps: ${CONFIG.mapsLink}\n\n¬øQuieres que se abra el mapa? (Puedes presionar ‚ÄúGoogle Maps‚Äù arriba)`);
    speak("Te comparto la ubicaci√≥n del colegio.");
    return;
  }

  if(intent === "oferta"){
    showTyping(650);
    addMsg(`üìö Oferta acad√©mica\n\n${CONFIG.academicOffer.join("\n")}\n\nSi deseas detalles de un nivel espec√≠fico, escr√≠belo.`);
    speak("Te comparto la oferta acad√©mica.");
    return;
  }

  if(intent === "contacto"){
    showTyping(650);
    addMsg(`üìû Contacto\n\nüìû Tel√©fono: ${CONFIG.phoneDisplay}\nüí¨ WhatsApp: https://wa.me/${CONFIG.whatsappNumber}\n‚úâÔ∏è Correo: ${CONFIG.emailTo}\n\n¬øPrefieres llamar o escribir por WhatsApp?`);
    speak("Te comparto el contacto.");
    return;
  }

  if(intent === "humano"){
    return escalateUnknown(userText);
  }

  // ‚úÖ Si no sabe ‚Üí WhatsApp autom√°tico (tu requisito)
  return escalateUnknown(userText);
}

/* =========================
   EVENTOS UI
   ========================= */
fab.addEventListener("click", openWidget);
$("#btnClose").addEventListener("click", closeWidget);
$("#btnMin").addEventListener("click", minimizeWidget);

$("#btnVoice").addEventListener("click", () => {
  state.voiceEnabled = !state.voiceEnabled;
  $("#btnVoice").textContent = state.voiceEnabled ? "üîä" : "üîá";
  showTyping(450);
  addMsg(state.voiceEnabled ? "üîä Voz activada." : "üîá Voz desactivada.");
  if(state.voiceEnabled) speak("Voz activada.");
});

$("#ctaEnroll").addEventListener("click", () => respond("matricula"));
$("#ctaMaps").addEventListener("click", () => {
  if(CONFIG.mapsLink && !CONFIG.mapsLink.includes("PEGA_AQUI")) window.open(CONFIG.mapsLink, "_blank");
  else escalateUnknown("Google Maps (falta el mapLink).");
});
$("#ctaWa").addEventListener("click", () => openWhatsApp(`Hola, necesito informaci√≥n del ${CONFIG.schoolName}.`));

document.addEventListener("click", (e) => {
  const action = e.target?.dataset?.action;
  if(action){
    if(action === "humano") return escalateUnknown("Atenci√≥n administrativa");
    respond(action);
  }
  const fb = e.target?.dataset?.feedback;
  if(fb === "down"){
    // Si dicen "No", mandar a WhatsApp
    return escalateUnknown("Feedback: respuesta insuficiente");
  }
  if(fb === "up"){
    showTyping(450);
    addMsg("¬°Gracias! ‚úÖ Me alegra haberte ayudado.");
    speak("Gracias. Me alegra haber ayudado.");
  }
});

$("#sendBtn").addEventListener("click", sendUserText);
input.addEventListener("keydown", (e) => { if(e.key === "Enter") sendUserText(); });

function sendUserText(){
  const text = input.value.trim();
  if(!text) return;
  addMsg(text, "user");
  input.value = "";
  const intent = detectIntent(text);
  respond(intent, text);
}

/* =========================
   FORMULARIO CORREO (mailto)
   ========================= */
$("#btnMail").addEventListener("click", () => {
  const name = ($("#fName").value || "").trim();
  const email = ($("#fEmail").value || "").trim();
  const msg = ($("#fMsg").value || "").trim();

  const subject = `Consulta ‚Äì ${CONFIG.schoolName}`;
  const body =
`Hola, soy ${name || "‚Äî"}.
Mi correo: ${email || "‚Äî"}.

Mensaje:
${msg || "‚Äî"}

Enviado desde EmaBot.`;

  const mailto = `mailto:${encodeURIComponent(CONFIG.emailTo)}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  window.location.href = mailto;

  showTyping(450);
  addMsg("‚úâÔ∏è Listo. Se abrir√° tu correo para enviar el mensaje.");
  speak("Listo. Se abrir√° tu correo para enviar el mensaje.");
});

/* Mensaje inicial cuando se abre por primera vez */
window.addEventListener("load", () => {
  // El widget inicia cerrado (plegable). Si quieres que se abra solo, descomenta:
  // openWidget();
});
</script>

</body>
</html>
