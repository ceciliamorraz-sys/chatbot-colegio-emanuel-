<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EmaBot - Colegio Integral Emanuel</title>

<style>
body { font-family: Arial, sans-serif; }

#chat-btn{
  position:fixed; bottom:20px; right:20px;
  width:60px; height:60px;
  border-radius:50%;
  border:none; cursor:pointer;
  background:#1f6feb; color:#fff;
  font-size:26px;
  box-shadow:0 4px 10px rgba(0,0,0,.3);
  z-index:9999;
}

#chat-box{
  display:none;
  position:fixed;
  bottom:90px; right:20px;
  width:360px; height:520px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 8px 18px rgba(0,0,0,.25);
  overflow:hidden;
  z-index:9999;
}

#chat-header{
  background:#1f6feb;
  color:#fff;
  padding:12px;
  font-weight:bold;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

#chat-messages{
  padding:12px;
  height:360px;
  overflow-y:auto;
  background:#f4f6f8;
}

.msg{
  background:#fff;
  padding:8px 10px;
  margin-bottom:8px;
  border-radius:8px;
  font-size:14px;
}

.user{ background:#dff3ff; text-align:right; }

#typing{ font-style:italic; color:#666; display:none; }

#chat-input{
  display:flex;
  gap:6px;
  padding:10px;
  border-top:1px solid #ddd;
}

#chat-input input{
  flex:1;
  padding:8px;
  border-radius:8px;
  border:1px solid #ccc;
}

#chat-input button{
  padding:8px 12px;
  background:#1f6feb;
  color:#fff;
  border:none;
  border-radius:8px;
  cursor:pointer;
}
</style>
</head>

<body>

<button id="chat-btn">üí¨</button>

<div id="chat-box">
  <div id="chat-header">
    ü§ñ EmaBot ‚Äì Colegio Integral Emanuel
    <span style="cursor:pointer" onclick="toggleChat()">‚úñ</span>
  </div>

  <div id="chat-messages"></div>
  <div id="typing">‚úçÔ∏è EmaBot est√° escribiendo‚Ä¶</div>

  <div id="chat-input">
    <input id="user-input" placeholder="Escribe tu pregunta aqu√≠...">
    <button onclick="handleUser()">Enviar</button>
  </div>
</div>

<script>
const chatBtn = document.getElementById("chat-btn");
const chatBox = document.getElementById("chat-box");
const messages = document.getElementById("chat-messages");
const typing = document.getElementById("typing");
let greeted = false;

chatBtn.onclick = toggleChat;

function toggleChat(){
  chatBox.style.display = chatBox.style.display === "block" ? "none" : "block";

  if(!greeted){
    greeted = true;
    bot("üëã Bienvenido al Colegio Integral Emanuel.");
    bot("Soy EmaBot, el asistente virtual institucional.");
    bot("‚è∞ Horario de atenci√≥n: Lunes a Viernes, 7:00 a.m. a 3:00 p.m.");
    bot("üìñ El texto b√≠blico de hoy es:\n‚ÄúInstruye al ni√±o en su camino, y aun cuando fuere viejo no se apartar√° de √©l.‚Äù (Proverbios 22:6)");
    bot("üòä ¬øEn qu√© m√°s podemos ayudarte?");
  }
}

function bot(text){
  const d = document.createElement("div");
  d.className="msg";
  d.innerText=text;
  messages.appendChild(d);
  messages.scrollTop=messages.scrollHeight;
}

function user(text){
  const d = document.createElement("div");
  d.className="msg user";
  d.innerText=text;
  messages.appendChild(d);
  messages.scrollTop=messages.scrollHeight;
}

function normalize(t){
  return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");
}

function handleUser(){
  const input=document.getElementById("user-input");
  if(!input.value) return;

  const q=input.value;
  input.value="";
  user(q);

  typing.style.display="block";

  setTimeout(()=> {
    typing.style.display="none";
    answer(q);
  }, 900);
}

function answer(q){
  const t=normalize(q);

  if(t.includes("direccion") || t.includes("ubicacion")){
    bot("üìç Costado Este del MaxiPali, 25 varas al norte.");
    return;
  }

  if(t.includes("mensualidad") || t.includes("cuota")){
    bot("üìÖ La mensualidad es de C$ 1,450.");
    return;
  }

  if(t.includes("matricula") || t.includes("inscripcion")){
    bot("üíµ La informaci√≥n de matr√≠cula se brinda directamente por WhatsApp.");
    window.open("https://wa.me/50588543012","_blank");
    return;
  }

  if(t.includes("ofrece") || t.includes("educacion")){
    bot("üéì Ofrecemos educaci√≥n integral, formaci√≥n en valores cristianos y un ambiente seguro.");
    return;
  }

  bot("üì≤ Para brindarte una mejor atenci√≥n, te comunicamos con secretar√≠a.");
  window.open("https://wa.me/50588543012","_blank");
  bot("‚ú® Bendiciones, quedamos a su disposici√≥n.");
}
</script>

</body>
</html>
